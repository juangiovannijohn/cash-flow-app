<div class="bg-transparent text-text w-full min-h-screen  p-4 sm:pt-10 md:pt-20 sm:px-14 md:pr-20">
  <div>
    <h2 class="text-xl text-start font-semibold text-accent mb-2">Editar perfil</h2>
    <!-- <form [formGroup]="updateProfileForm" (ngSubmit)="updateProfile()" class="form-widget">
      <div>
        <label class="font-medium mb-1" for="email">Email</label>
        <input id="email" type="text" [value]="session.user.email" disabled />
      </div>
      <div>
        <label class="font-medium mb-1" for="username">Name</label>
        <input formControlName="username" id="username" type="text" />
      </div>
      <div>
        <label class="font-medium mb-1" for="website">Website</label>
        <input formControlName="website" id="website" type="url" />
      </div>

      <div>
        <button type="submit" class="button primary block" [disabled]="loading">
          {{ loading ? 'Loading ...' : 'Update' }}
        </button>
      </div>

      <div>
        <button class="button block p-4 bg-primary text-text font-semibold text-lg my-3" (click)="signOut()">Sign
          Out</button>
      </div>
    </form> -->
  </div>
  <div>
    <h2 class="text-xl text-start font-semibold text-accent mb-2">Categorias personalizadas</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3">
      <div class="">
        <h3 class="text-lg text-start font-semibold text-text mb-2">Gastos</h3>

        <div
          class="bg-accent bg-opacity-80 text-backg p-2 rounded-md mb-2 hover:bg-opacity-100 hover:cursor-pointer ease-in-out duration-200">
          <div (click)="showFormNewExpense = !showFormNewExpense">
            <h4
              class="text-base text-start font-semibold text-backg uppercase hover:underline hover:underline-offset-4 ease-in-out duration-200">
              Nueva Categoria </h4>
          </div>
          <div [ngClass]="{ 'hidden': !showFormNewExpense }">

            <form class="grid grid-cols-1" [formGroup]="categoryExpensesForm" (ngSubmit)="createCategoryExpense()">
              <label class="mb-1" for="category_name">Nombre Categoría</label>
              <input class="bg-backg rounded-sm p-1 w-full text-text text-opacity-50 mb-2" type="text"
                id="category_name" formControlName="category_name" placeholder="Alimentos" />
              <div *ngIf="
              categoryExpensesForm.get('category_name')?.invalid && categoryExpensesForm.get('category_name')?.touched
                " class="text-red">
                Error.
              </div>
              <label class="mb-1" for="category_expense_description">Descripción</label>
              <input class="bg-backg rounded-sm p-1 w-full text-text text-opacity-50 mb-2" type="text"
                id="category_expense_description" formControlName="category_expense_description"
                placeholder="Solo lo comprado en supermercado" />
              <div *ngIf="
                  categoryExpensesForm.get('category_expense_description')?.invalid" class="text-red">
                Error.
              </div>
              <label class="mb-1" for="budget_amount">Monto asignado a gastar</label>
              <input class="bg-backg rounded-sm p-1 w-full text-text text-opacity-50 mb-2" type="number"
                id="budget_amount" formControlName="budget_amount"
                placeholder="$40000" />
              <div *ngIf="
                  categoryExpensesForm.get('budget_amount')?.invalid" class="text-red">
                Error.
              </div>
              <input class="hidden" type="text" hidden id="user_uuid" formControlName="user_uuid" />
              <div class="flex flex-row justify-start">
                <button [ngClass]="{ 'opacity-60': !categoryExpensesForm.valid }"
                  [disabled]="!categoryExpensesForm.valid" type="submit"
                  class="bg-text py-1 px-3 rounded-md opacity-80 hover:opacity-100 ease-in-out duration-200 text-backg">
                  Crear categoría</button>
              </div>

            </form>
          </div>
        </div>

        <ng-container *ngFor="let catExp of categoriesExpenses ">
          <div class="bg-gris p-2 rounded-md mb-2 hover:bg-opacity-75 hover:cursor-pointer ease-in-out duration-200">
            <div (click)="catExp.showDetails = !catExp.showDetails">
              <h4
                class="text-base text-start font-semibold text-accent mb-2 uppercase hover:underline hover:underline-offset-4 ease-in-out duration-200">
                {{ catExp.category_name }} <span class="text-text font-light opacity-70 text-sm" *ngIf="catExp.budget_expected !== null">({{  catExp.budget_expected | ARS }})</span>
              </h4>
              <p [ngClass]="{ 'hidden': catExp.showDetails }" class="text-sm text-start">
                {{catExp.category_expense_description}}
              </p>
            </div>
            <div [ngClass]="{ 'hidden': !catExp.showDetails }">
              <div class="mb-2">
                <label class="mb-1" for="">Nombre categoría</label>
                <input class="bg-backg rounded-sm p-1 w-full text-text text-opacity-50 " name="" type="text" required
                  [(ngModel)]="catExp.category_name">
              </div>
              <div class="mb-2">
                <label class="mb-1" for="">Descripción</label>
                <input class="bg-backg rounded-sm p-1 w-full text-text text-opacity-50 " name="" type="text"
                  [(ngModel)]="catExp.category_expense_description">
              </div>
              <div class="mb-2">
                <label class="mb-1" for="budget_amount">Monto presupuestado</label>
                <input class="bg-backg rounded-sm p-1 w-full text-text text-opacity-50 mb-2" type="number"
                  id="budget_amount" [(ngModel)]="catExp.budget_expected" />
                <div *ngIf="
                    categoryExpensesForm.get('budget_amount')?.invalid" class="text-red">
                  Error.
                </div>
              </div>
              <div class="flex flex-row justify-between">
                <button class="bg-primary py-1 px-3 rounded-md opacity-80 hover:opacity-100 ease-in-out duration-200"
                  (click)="updateCategoryExpense(catExp.id, catExp.category_name,  catExp.category_expense_description, catExp.budget_expected, catExp.budget_id )">
                  Actualizar</button>
                <button class="text-red py-1 px-3 rounded-md opacity-80 hover:opacity-100 ease-in-out duration-200"
                  (click)="deleteCategoryExpense(catExp.id)">
                  Borrar
                </button>
              </div>
            </div>
          </div>
        </ng-container>
      </div>
      <div class="">
        <h3 class="text-lg text-start font-semibold text-text mb-2">Ingresos</h3>
        <!-- Nueva Categoría -->
        <div
          class="bg-accent bg-opacity-80 text-backg p-2 rounded-md mb-2 hover:bg-opacity-100 hover:cursor-pointer ease-in-out duration-200">
          <div (click)="showFormNewIncome = !showFormNewIncome">
            <h4
              class="text-base text-start font-semibold text-backg uppercase hover:underline hover:underline-offset-4 ease-in-out duration-200">
              Nueva Categoria </h4>
          </div>
          <div [ngClass]="{ 'hidden': !showFormNewIncome }">
            <form class="grid grid-cols-1" [formGroup]="categoryIncomeForm" (ngSubmit)="createCategoryIncome()">
              <label class="mb-1" for="category_name">Nombre Categoría</label>
              <input class="bg-backg rounded-sm p-1 w-full text-text text-opacity-50 mb-2" type="text"
                id="category_name" formControlName="category_name" placeholder="Sueldo" />
              <div *ngIf="
              categoryIncomeForm.get('category_name')?.invalid && categoryIncomeForm.get('category_name')?.touched
                " class="text-red">
                Error.
              </div>
              <label class="mb-1" for="category_income_description">Descripción</label>
              <input class="bg-backg rounded-sm p-1 w-full text-text text-opacity-50 mb-2" type="text"
                id="category_income_description" formControlName="category_income_description"
                placeholder="Solo lo comprado en supermercado" />
              <div *ngIf="
                  categoryIncomeForm.get('category_income_description')?.invalid" class="text-red">
                Error.
              </div>
              <input class="hidden" type="text" hidden id="user_uuid" formControlName="user_uuid" />
              <div class="flex flex-row justify-start">
                <button [ngClass]="{ 'opacity-60': !categoryExpensesForm.valid }"
                  [disabled]="!categoryExpensesForm.valid" type="submit"
                  class="bg-text py-1 px-3 rounded-md opacity-80 hover:opacity-100 ease-in-out duration-200 text-backg">
                  Crear categoría</button>
              </div>
            </form>
          </div>
        </div>

        <ng-container *ngFor="let catInc of categoriesIncomes">
          <div class="bg-gris p-2 rounded-md mb-2 hover:bg-opacity-75 hover:cursor-pointer ease-in-out duration-200">
            <div (click)="catInc.showDetails = !catInc.showDetails">
              <h4
                class="text-base text-start font-semibold text-accent mb-2 uppercase hover:underline hover:underline-offset-4 ease-in-out duration-200">
                {{ catInc.category_name }}</h4>
              <p [ngClass]="{ 'hidden': catInc.showDetails }" class="text-sm text-start">{{
                catInc.category_income_description }} </p>
            </div>
            <div [ngClass]="{ 'hidden': !catInc.showDetails }">
              <div class="mb-2">
                <label class="mb-1" for="">Nombre categoría</label>
                <input class="bg-backg rounded-sm p-1 w-full text-text text-opacity-50 " name="" type="text" required
                  [(ngModel)]="catInc.category_name">
              </div>
              <div class="mb-2">
                <label class="mb-1" for="">Descripción</label>
                <input class="bg-backg rounded-sm p-1 w-full text-text text-opacity-50 " name="" type="text"
                  [(ngModel)]="catInc.category_income_description">
              </div>
              <div class="flex flex-row justify-between">
                <button class="bg-primary py-1 px-1 rounded-md opacity-80 hover:opacity-100 ease-in-out duration-200"
                  (click)="updateCategoryIncome(catInc.id, catInc.category_name,  catInc.category_income_description)">
                  Actualizar</button>
                <button class="text-red py-1 px-3 rounded-md opacity-80 hover:opacity-100 ease-in-out duration-200"
                  (click)="deleteCategoryIncome(catInc.id)">
                  Borrar
                </button>
              </div>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>